#!/usr/local/bin/node
"use strict";function _interopRequireDefault(a){return a&&a.__esModule?a:{"default":a}}function _toConsumableArray(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}function handle(a,b){functions.push(["string"==typeof a?function(b){return b[0]==a}:a,"string"==typeof b?function(a){return translate([b].concat(_toConsumableArray(a)))}:b])}function match(a){var b=!0,c=!1,d=void 0;try{for(var f,e=functions[Symbol.iterator]();!(b=(f=e.next()).done);b=!0){var g=f.value;if(g[0](a))return g[1]}}catch(h){c=!0,d=h}finally{try{!b&&e["return"]&&e["return"]()}finally{if(c)throw d}}return null}function translate(a){for(var b=!0;b;){var c=a;if(d=e=void 0,b=!1,!(c instanceof Array))return c.toString();var d=match(c);if(!d)return c[0]+"("+c.slice(1).map(function(a){return translate(a)}).join(", ")+")";var e=d(c.slice(1));if("string"==typeof e)return e;a=e,b=!0}}function lisp(a){var b=a.replace(/\(\)/,"(_)").replace(/\(/g,"( ").replace(/\)/g," )").match(/'[^']*'|[^ ]+/g).join(" ").replace(/('[^']*'|[^ ]+)/g,'"$1"').replace(/"\(" /g,"[").replace(/ "\)"/g,"]").match(/\S+/g).join(", "),c=JSON.parse(b);return translate(c)}function write(a,b){return 1===b&&console.log(a),_fs2["default"].writeFile(b,a,function(a){return console.log(a||"Compilation Done")})}function run(){_yargs.argv.language&&"javascript"!==_yargs.argv.language||javascript(handle,translate),write(lisp(format(_fs2["default"].readFileSync(_yargs.argv._[0]).toString())),_yargs.argv.output||1)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.handle=handle,exports.run=run;var _fs=require("fs"),_fs2=_interopRequireDefault(_fs),_yargs=require("yargs"),functions=[],javascript=function(a,b){var c=function(a,b){return"("+a+")"};a("+",function(a){return a.map(function(a){return c(b(a))}).join(" + ")}),a("*",function(a){return a.map(function(a){return c(b(a))}).join(" * ")}),a("-",function(a){return a.map(function(a){return c(b(a))}).join(" - ")}),a("/",function(a){return a.map(function(a){return c(b(a))}).join(" / ")}),a("%",function(a){return a.map(function(a){return c(b(a))}).join(" % ")}),a(">",function(a){return a.map(function(a){return c(b(a))}).join(" > ")}),a("<",function(a){return a.map(function(a){return c(b(a))}).join(" < ")}),a("<=",function(a){return a.map(function(a){return c(b(a))}).join(" <= ")}),a(">=",function(a){return a.map(function(a){return c(b(a))}).join(" >= ")}),a("==",function(a){return a.map(function(a){return c(b(a))}).join(" == ")}),a("quote",function(a){return"["+a.map(function(a){return b(a)}).join(", ")+"]"}),a("if",function(a){return 2===a.length?"(function () {if ("+b(a[0])+") return "+b(a[1])+"})()":3===a.length?"(("+b(a[0])+") ? ("+b(a[1])+") : ("+b(a[2])+"))":void 0}),a("map",function(a){var c=b(a[0]),d=b(a[1]);return c+".map("+d+")"}),a("with",function(a){var c=a.pop(),d=a.map(function(a){return a[0]}).join(","),e=a.map(function(a){return b(a[1])}).join(",");return"(function("+d+") {\n        "+b(c)+";\n  })("+b(e)+");"}),a("do",function(a){return"(function () {\n      "+(a.map(function(a){return b(a)}).join(";\n")+";\n")+"\n  })()"}),a("return",function(a){return"(function () {\n      return "+a[1]+";\n    })()"}),a("def",function(a){var c=void 0,d=void 0,e=void 0;return 2==a.length?(d=a[1][0]instanceof Array?a[1]:a[1],e=a[0].join(", "),c=""):1==a.length?(d=a[0][0]instanceof Array?a[0]:a[0],e="",c=""):(c=a[0],e=a[1],d=a[2][0]instanceof Array?a[2]:a[2]),"function "+c+"("+e+") {\n    return "+b(d)+";\n  }"})},format=function(a){return a.replace(/\n+/g,"").replace(/\s+/," ").replace(/"/g,'\\"')};run();
